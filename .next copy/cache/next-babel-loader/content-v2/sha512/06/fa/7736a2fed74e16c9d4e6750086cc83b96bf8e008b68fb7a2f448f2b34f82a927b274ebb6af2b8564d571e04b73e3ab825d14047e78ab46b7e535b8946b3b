{"ast":null,"code":"import NextAuth from 'next-auth';\nimport Providers from 'next-auth/providers'; // import useSWR from 'swr';\n// import fetch from 'unfetch';\n// const data = getUsuarios();\n// Configure one or more authentication providers\n\n/* function Useres() {\r\n  const fetcher = (url) => fetch(url).then((r) => r.json());\r\n  const { data } = useSWR('/api/getUser', fetcher);\r\n  valorUsuario = 'JSON.parse(JSON.stringify(data))';\r\n  console.log(valorUsuario);\r\n  return data;\r\n} */\n// const fetcher = (url) => fetch(url).then((r) => r.json());\n// const { data } => //useSWR('/api/getUser', fetcher);\n// console.log(data);\n\nconst options = {\n  pages: {\n    //  signIn: '/auth/signin',\n    //  signOut: '/auth/signout',\n    //   error: '/auth/error', // Error code passed in query string as ?error=\n    //   verifyRequest: '/auth/verify-request', // (used for check email message)\n    newUser: '/auth/userPerfil' // If set, new users will be directed here on first sign in\n\n  },\n  providers: [// ...add more providers here\n  Providers.Google({\n    clientId: process.env.GOOGLE_CLIENT_ID,\n    clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n    authorizationUrl: 'https://accounts.google.com/o/oauth2/v2/auth?prompt=consent&access_type=offline&response_type=code',\n    callbackUrl: `${window.location.origin}/pefil` // $ { id }\n\n  })\n  /*   Providers.Facebook({\r\n    clientId: process.env.FACEBOOK_CLIENT_ID,\r\n    clientSecret: process.env.FACEBOOK_CLIENT_SECRET,\r\n  }), */\n  ],\n  callbacks: {\n    async signIn(user, account, profile) {\n      //      const dados = await prisma.Usuarios({ loginUsuario: user });\n      // if (!data) return <div>loading...</div>;\n      //   return <div>hello {data.name}!</div>;\n\n      /* const dados = JSON.parse(\r\n        JSON.stringify(usuarios.filter((item) => item.email === profile.email)),\r\n      ); */\n      //   const verifiedEmail = dados[0].email;\n      // console.log(profile.email, dados[0], valorUsuario);\n      if (account.provider === 'google' && profile.verified_email === true //  profile.email.endsWith(verifiedEmail)\n      ) {\n          return true;\n        }\n\n      return false;\n    }\n\n  },\n  session: {\n    jwt: true\n  },\n  jwt: {\n    secret: process.env.JWT_SECRET\n  } // A database is optional, but required to persist accounts in a database\n  // database: process.env.DATABASE_URL,\n\n};\nexport default ((req, res) => NextAuth(req, res, options));","map":{"version":3,"sources":["E:/src/next/sistemas/idpb-app/src/pages/api/auth/[...nextauth].js"],"names":["NextAuth","Providers","options","pages","newUser","providers","Google","clientId","process","env","GOOGLE_CLIENT_ID","clientSecret","GOOGLE_CLIENT_SECRET","authorizationUrl","callbackUrl","window","location","origin","callbacks","signIn","user","account","profile","provider","verified_email","session","jwt","secret","JWT_SECRET","req","res"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,WAArB;AACA,OAAOC,SAAP,MAAsB,qBAAtB,C,CACA;AACA;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;AACA,MAAMC,OAAO,GAAG;AACdC,EAAAA,KAAK,EAAE;AACL;AACA;AACA;AACA;AACAC,IAAAA,OAAO,EAAE,kBALJ,CAKwB;;AALxB,GADO;AAQdC,EAAAA,SAAS,EAAE,CACT;AACAJ,EAAAA,SAAS,CAACK,MAAV,CAAiB;AACfC,IAAAA,QAAQ,EAAEC,OAAO,CAACC,GAAR,CAAYC,gBADP;AAEfC,IAAAA,YAAY,EAAEH,OAAO,CAACC,GAAR,CAAYG,oBAFX;AAGfC,IAAAA,gBAAgB,EACd,oGAJa;AAKfC,IAAAA,WAAW,EAAG,GAAEC,MAAM,CAACC,QAAP,CAAgBC,MAAO,QALxB,CAKiC;;AALjC,GAAjB;AAOA;AACJ;AACA;AACA;AAZa,GARG;AAsBdC,EAAAA,SAAS,EAAE;AACT,UAAMC,MAAN,CAAaC,IAAb,EAAmBC,OAAnB,EAA4BC,OAA5B,EAAqC;AACnC;AAEA;AACA;;AAEA;AACN;AACA;AACM;AAEA;AACA,UACED,OAAO,CAACE,QAAR,KAAqB,QAArB,IACAD,OAAO,CAACE,cAAR,KAA2B,IAF7B,CAEkC;AAFlC,QAGE;AACA,iBAAO,IAAP;AACD;;AACD,aAAO,KAAP;AACD;;AApBQ,GAtBG;AA4CdC,EAAAA,OAAO,EAAE;AACPC,IAAAA,GAAG,EAAE;AADE,GA5CK;AA+CdA,EAAAA,GAAG,EAAE;AACHC,IAAAA,MAAM,EAAEnB,OAAO,CAACC,GAAR,CAAYmB;AADjB,GA/CS,CAkDd;AACA;;AAnDc,CAAhB;AAsDA,gBAAe,CAACC,GAAD,EAAMC,GAAN,KAAc9B,QAAQ,CAAC6B,GAAD,EAAMC,GAAN,EAAW5B,OAAX,CAArC","sourcesContent":["import NextAuth from 'next-auth';\r\nimport Providers from 'next-auth/providers';\r\n// import useSWR from 'swr';\r\n// import fetch from 'unfetch';\r\n\r\n// const data = getUsuarios();\r\n// Configure one or more authentication providers\r\n\r\n/* function Useres() {\r\n  const fetcher = (url) => fetch(url).then((r) => r.json());\r\n  const { data } = useSWR('/api/getUser', fetcher);\r\n  valorUsuario = 'JSON.parse(JSON.stringify(data))';\r\n  console.log(valorUsuario);\r\n  return data;\r\n} */\r\n\r\n// const fetcher = (url) => fetch(url).then((r) => r.json());\r\n// const { data } => //useSWR('/api/getUser', fetcher);\r\n// console.log(data);\r\nconst options = {\r\n  pages: {\r\n    //  signIn: '/auth/signin',\r\n    //  signOut: '/auth/signout',\r\n    //   error: '/auth/error', // Error code passed in query string as ?error=\r\n    //   verifyRequest: '/auth/verify-request', // (used for check email message)\r\n    newUser: '/auth/userPerfil', // If set, new users will be directed here on first sign in\r\n  },\r\n  providers: [\r\n    // ...add more providers here\r\n    Providers.Google({\r\n      clientId: process.env.GOOGLE_CLIENT_ID,\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\r\n      authorizationUrl:\r\n        'https://accounts.google.com/o/oauth2/v2/auth?prompt=consent&access_type=offline&response_type=code',\r\n      callbackUrl: `${window.location.origin}/pefil`, // $ { id }\r\n    }),\r\n    /*   Providers.Facebook({\r\n      clientId: process.env.FACEBOOK_CLIENT_ID,\r\n      clientSecret: process.env.FACEBOOK_CLIENT_SECRET,\r\n    }), */\r\n  ],\r\n  callbacks: {\r\n    async signIn(user, account, profile) {\r\n      //      const dados = await prisma.Usuarios({ loginUsuario: user });\r\n\r\n      // if (!data) return <div>loading...</div>;\r\n      //   return <div>hello {data.name}!</div>;\r\n\r\n      /* const dados = JSON.parse(\r\n        JSON.stringify(usuarios.filter((item) => item.email === profile.email)),\r\n      ); */\r\n      //   const verifiedEmail = dados[0].email;\r\n\r\n      // console.log(profile.email, dados[0], valorUsuario);\r\n      if (\r\n        account.provider === 'google' &&\r\n        profile.verified_email === true //  profile.email.endsWith(verifiedEmail)\r\n      ) {\r\n        return true;\r\n      }\r\n      return false;\r\n    },\r\n  },\r\n  session: {\r\n    jwt: true,\r\n  },\r\n  jwt: {\r\n    secret: process.env.JWT_SECRET,\r\n  },\r\n  // A database is optional, but required to persist accounts in a database\r\n  // database: process.env.DATABASE_URL,\r\n};\r\n\r\nexport default (req, res) => NextAuth(req, res, options);\r\n"]},"metadata":{},"sourceType":"module"}