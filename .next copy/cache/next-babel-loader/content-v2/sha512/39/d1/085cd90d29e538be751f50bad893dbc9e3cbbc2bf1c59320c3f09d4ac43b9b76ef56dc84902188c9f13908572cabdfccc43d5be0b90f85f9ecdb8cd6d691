{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"E:\\\\src\\\\next\\\\sistemas\\\\idpb-app\\\\src\\\\components\\\\relatorios\\\\userTelas\\\\graficos2.js\";\nimport React from 'react';\nimport { Line, Bar, Pie } from '@reactchartjs/react-chart.js';\nimport { signOut } from 'next-auth/client';\nimport useSWR from 'swr';\nimport axios from 'axios';\nimport 'chartjs-plugin-datalabels';\n\nconst fetcher = url => axios.get(url).then(res => res.data);\n\nfunction Graficos({\n  item,\n  secao,\n  Data,\n  tipo\n}) {\n  const dadosUser = item.filter(val => val.email === secao.user.email);\n\n  if (dadosUser.length === 0) {\n    signOut({\n      callbackUrl: `${window.location.origin}`\n    });\n  }\n\n  const mes = String(Number(Data.slice(3, 5)));\n  const ano = Data.slice(6, 10); //  const [session] = useSession();\n\n  const url = `${window.location.origin}/api/consultaDados/${item[0].codigoIgreja}/${mes}/${ano}`;\n  const visitantes = [];\n  const conversoes = [];\n  const ofertas = [];\n  const {\n    data\n  } = useSWR(url, fetcher);\n\n  if (data) {\n    for (let i = 0; i < data.length; i += 1) {\n      //    adultos[data[i].semana - 1] = data[i].adultos;\n      //    crianças[data[i].semana - 1] = data[i].criancas;\n      visitantes[data[i].semana - 1] = data[i].visitantes;\n      conversoes[data[i].semana - 1] = data[i].conversoes;\n      ofertas[data[i].semana - 1] = data[i].ofertas.replace(',', '.'); // console.log(ofertas);\n    }\n  }\n\n  const dataGrafic = {\n    labels: ['Semana-1', 'Semana-2', 'Semana-3', 'Semana-4'],\n    datasets: [{\n      label: 'Visit.',\n      data: visitantes,\n      fill: false,\n      backgroundColor: '#ffa726',\n      borderColor: '#ff9800',\n      yAxisID: 'y-axis-1'\n    }, {\n      label: 'Conver.',\n      data: conversoes,\n      fill: false,\n      backgroundColor: '#43a047',\n      borderColor: '#388e3c',\n      yAxisID: 'y-axis-1'\n    }, {\n      label: 'Ofertas',\n      data: ofertas,\n      fill: false,\n      backgroundColor: '#283593',\n      borderColor: '#1a237e',\n      yAxisID: 'y-axis-2'\n    }]\n  };\n  const dataGrafic2 = {\n    labels: ['S1', 'S2', 'S3', 'S4', 'S5'],\n    datasets: [{\n      label: 'Ofertas do Mês',\n      data: [ofertas[0], ofertas[1], ofertas[2], ofertas[3], ofertas[4]],\n      backgroundColor: ['#388e3c', '#283593', '#ff9800', '#546e7a'],\n      borderColor: ['#43a047', '#1a237e', '#ffa726', '#6d4c41', '#78909c'],\n      borderWidth: 1\n    }]\n  };\n  const options = {\n    plugins: {\n      datalabels: {\n        formatter: (value, ctx) => {\n          const {\n            datasets\n          } = ctx.chart.dataGrafic2;\n\n          if (datasets.indexOf(ctx.dataset) === datasets.length - 1) {\n            const sum = datasets[0].data.reduce((a, b) => a + b, 0);\n            const percentage = `${Math.round(value / sum * 100)}%`;\n            return percentage;\n          }\n\n          return 'percentage';\n        },\n        color: 'red'\n      }\n    },\n    scales: {\n      yAxes: [{\n        ticks: {\n          beginAtZero: true\n        },\n        type: 'linear',\n        display: true,\n        position: 'left',\n        id: 'y-axis-1',\n        showAllTooltips: false\n      }, {\n        ticks: {\n          beginAtZero: true\n        },\n        type: 'linear',\n        display: true,\n        position: 'right',\n        id: 'y-axis-2',\n        gridLines: {\n          drawOnArea: false\n        }\n      }]\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [tipo === 'linhas' ? /*#__PURE__*/_jsxDEV(Line, {\n      data: dataGrafic,\n      options: options\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 28\n    }, this) : null, tipo === 'barras' ? /*#__PURE__*/_jsxDEV(Bar, {\n      data: dataGrafic,\n      options: options\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 28\n    }, this) : null, tipo === 'acumulados' ? /*#__PURE__*/_jsxDEV(Pie, {\n      data: dataGrafic2\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 32\n    }, this) : null]\n  }, void 0, true);\n}\n\nexport default Graficos;","map":{"version":3,"sources":["E:/src/next/sistemas/idpb-app/src/components/relatorios/userTelas/graficos2.js"],"names":["React","Line","Bar","Pie","signOut","useSWR","axios","fetcher","url","get","then","res","data","Graficos","item","secao","Data","tipo","dadosUser","filter","val","email","user","length","callbackUrl","window","location","origin","mes","String","Number","slice","ano","codigoIgreja","visitantes","conversoes","ofertas","i","semana","replace","dataGrafic","labels","datasets","label","fill","backgroundColor","borderColor","yAxisID","dataGrafic2","borderWidth","options","plugins","datalabels","formatter","value","ctx","chart","indexOf","dataset","sum","reduce","a","b","percentage","Math","round","color","scales","yAxes","ticks","beginAtZero","type","display","position","id","showAllTooltips","gridLines","drawOnArea"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport { Line, Bar, Pie } from '@reactchartjs/react-chart.js';\r\nimport { signOut } from 'next-auth/client';\r\nimport useSWR from 'swr';\r\nimport axios from 'axios';\r\nimport 'chartjs-plugin-datalabels';\r\n\r\nconst fetcher = (url) => axios.get(url).then((res) => res.data);\r\nfunction Graficos({ item, secao, Data, tipo }) {\r\n  const dadosUser = item.filter((val) => val.email === secao.user.email);\r\n  if (dadosUser.length === 0) {\r\n    signOut({\r\n      callbackUrl: `${window.location.origin}`,\r\n    });\r\n  }\r\n  const mes = String(Number(Data.slice(3, 5)));\r\n  const ano = Data.slice(6, 10);\r\n  //  const [session] = useSession();\r\n  const url = `${window.location.origin}/api/consultaDados/${item[0].codigoIgreja}/${mes}/${ano}`;\r\n\r\n  const visitantes = [];\r\n  const conversoes = [];\r\n  const ofertas = [];\r\n\r\n  const { data } = useSWR(url, fetcher);\r\n  if (data) {\r\n    for (let i = 0; i < data.length; i += 1) {\r\n      //    adultos[data[i].semana - 1] = data[i].adultos;\r\n      //    crianças[data[i].semana - 1] = data[i].criancas;\r\n      visitantes[data[i].semana - 1] = data[i].visitantes;\r\n      conversoes[data[i].semana - 1] = data[i].conversoes;\r\n      ofertas[data[i].semana - 1] = data[i].ofertas.replace(',', '.');\r\n      // console.log(ofertas);\r\n    }\r\n  }\r\n  const dataGrafic = {\r\n    labels: ['Semana-1', 'Semana-2', 'Semana-3', 'Semana-4'],\r\n    datasets: [\r\n      {\r\n        label: 'Visit.',\r\n        data: visitantes,\r\n        fill: false,\r\n        backgroundColor: '#ffa726',\r\n        borderColor: '#ff9800',\r\n        yAxisID: 'y-axis-1',\r\n      },\r\n      {\r\n        label: 'Conver.',\r\n        data: conversoes,\r\n        fill: false,\r\n        backgroundColor: '#43a047',\r\n        borderColor: '#388e3c',\r\n        yAxisID: 'y-axis-1',\r\n      },\r\n      {\r\n        label: 'Ofertas',\r\n        data: ofertas,\r\n        fill: false,\r\n        backgroundColor: '#283593',\r\n        borderColor: '#1a237e',\r\n        yAxisID: 'y-axis-2',\r\n      },\r\n    ],\r\n  };\r\n\r\n  const dataGrafic2 = {\r\n    labels: ['S1', 'S2', 'S3', 'S4', 'S5'],\r\n    datasets: [\r\n      {\r\n        label: 'Ofertas do Mês',\r\n        data: [ofertas[0], ofertas[1], ofertas[2], ofertas[3], ofertas[4]],\r\n        backgroundColor: ['#388e3c', '#283593', '#ff9800', '#546e7a'],\r\n        borderColor: ['#43a047', '#1a237e', '#ffa726', '#6d4c41', '#78909c'],\r\n        borderWidth: 1,\r\n      },\r\n    ],\r\n  };\r\n\r\n  const options = {\r\n    plugins: {\r\n      datalabels: {\r\n        formatter: (value, ctx) => {\r\n          const { datasets } = ctx.chart.dataGrafic2;\r\n\r\n          if (datasets.indexOf(ctx.dataset) === datasets.length - 1) {\r\n            const sum = datasets[0].data.reduce((a, b) => a + b, 0);\r\n            const percentage = `${Math.round((value / sum) * 100)}%`;\r\n            return percentage;\r\n          }\r\n          return 'percentage';\r\n        },\r\n        color: 'red',\r\n      },\r\n    },\r\n    scales: {\r\n      yAxes: [\r\n        {\r\n          ticks: { beginAtZero: true },\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'left',\r\n          id: 'y-axis-1',\r\n          showAllTooltips: false,\r\n        },\r\n        {\r\n          ticks: { beginAtZero: true },\r\n          type: 'linear',\r\n          display: true,\r\n          position: 'right',\r\n          id: 'y-axis-2',\r\n          gridLines: {\r\n            drawOnArea: false,\r\n          },\r\n        },\r\n      ],\r\n    },\r\n  };\r\n  return (\r\n    <>\r\n      {tipo === 'linhas' ? <Line data={dataGrafic} options={options} /> : null}\r\n      {tipo === 'barras' ? <Bar data={dataGrafic} options={options} /> : null}\r\n      {tipo === 'acumulados' ? <Pie data={dataGrafic2} /> : null}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Graficos;\r\n"]},"metadata":{},"sourceType":"module"}